!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("glob"),require("path"),require("fs")):"function"==typeof define&&define.amd?define("RootAppServer",["glob","path","fs"],t):"object"==typeof exports?exports.RootAppServer=t(require("glob"),require("path"),require("fs")):e.RootAppServer=t(e.glob,e.path,e.fs)}(this,(e,t,n)=>(()=>{"use strict";var o={57:function(e,t,n){var o,s=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,s)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=o(e),i=0;i<n.length;i++)"default"!==n[i]&&s(t,e,n[i]);return r(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.runRootProtoc=function(){const e=function(e="root-protoc.json"){const t={inputFiles:[],importPaths:["./src"],expandedInputFiles:[],passThroughOptions:[],outputPath:"./gen",multiArgument:null,scope:"",clientPackageName:"gen-client",sharedPackageName:"gen-shared",serverPackageName:"gen-server"},n=p.resolve("./"+e);if(!u.existsSync(n))return t;const o=JSON.parse(u.readFileSync(e,"utf-8"));o.scope||(console.error("ROOTPROTOC - Error: Scope must be defined in the config file"),process.exit(1));t.scope=o.scope,o.multi&&(t.multiArgument="--appclient_opt=multi");o.outputFolder&&(t.outputPath=o.outputFolder);o.protoPaths&&(t.importPaths=o.protoPaths);o.source&&(t.inputFiles=o.source);o.clientPackageName&&(t.clientPackageName=o.clientPackageName);o.sharedPackageName&&(t.sharedPackageName=o.sharedPackageName);o.serverPackageName&&(t.serverPackageName=o.serverPackageName);o.extraOptions&&(t.passThroughOptions=o.options);return t}(),t=function(e){return["types.proto","timestamp.proto"].map(t=>p.join(e,t))}(p.join(__dirname,"../protos/rootsdk")),n=d(function(e){const t=[];return e.forEach(e=>{e.includes("**")?t.push(...(0,c.globSync)(e,{windowsPathsNoEscape:!0,ignore:"node_modules/**"})):t.push(e)}),t}(e.inputFiles));e.expandedInputFiles=[...n,...t],e.outputPath=d(e.outputPath)[0],m(e.outputPath+"/shared/src"),m(e.outputPath+"/client/src"),m(e.outputPath+"/server/src");const o=p.join(__dirname,"../protos");e.importPaths=[...d(e.importPaths),o],function(e){const t=["--ts_opt=force_disable_services","--ts_opt=generate_dependencies",`--ts_out=${e.outputPath}/shared/src`,...e.importPaths.map(e=>`--proto_path=${e}`)],n=["--plugin=appclient",e.multiArgument,"--appclient_opt target=model",`--appclient_opt scope=${e.scope}`,`--appclient_out=${e.outputPath}/shared/src`,...e.importPaths.map(e=>`--proto_path=${e}`)],o=["--plugin=appclient",e.multiArgument,"--appclient_opt target=client",`--appclient_opt scope=${e.scope}`,`--appclient_opt shared=${e.sharedPackageName}`,`--appclient_out=${e.outputPath}/client/src`,...e.importPaths.map(e=>`--proto_path=${e}`)],s=["--plugin=appclient",e.multiArgument,"--appclient_opt target=server",`--appclient_opt scope=${e.scope}`,`--appclient_opt shared=${e.sharedPackageName}`,`--appclient_out=${e.outputPath}/server/src`,...e.importPaths.map(e=>`--proto_path=${e}`)],r=[`npx protoc ${t.join(" ")} ${e.passThroughOptions.join(" ")} ${e.expandedInputFiles.join(" ")}`,`npx protoc ${n.join(" ")} ${e.passThroughOptions.join(" ")} ${e.expandedInputFiles.join(" ")}`,`npx protoc ${o.join(" ")} ${e.passThroughOptions.join(" ")} ${e.expandedInputFiles.join(" ")}`,`npx protoc ${s.join(" ")} ${e.passThroughOptions.join(" ")} ${e.expandedInputFiles.join(" ")}`],i={cwd:__dirname,stdio:"inherit"};l(r,i)}(e),function(e){(function(e,t,n){const o=(new Date).getTime(),s=`{\n  "name": "${t}/${n}",\n  "version": "1.0.${o}",\n  "main": "./dist/cjs/index.js",\n  "typings": "./dist/cjs/index.d.ts",\n  "module": "./dist/mjs/index.js",\n  "exports": {\n    "import": "./dist/mjs/index.js",\n    "require": "./dist/cjs/index.js",\n    "default": "./dist/cjs/index.js"\n  },\n  "scripts": {\n    "build": ""\n  }\n}`;u.writeFileSync(e,s)})(e.outputPath+"/shared/package.json",e.scope,e.sharedPackageName),function(e,t,n,o=!1){const s=(new Date).getTime();let r="";o&&(r=`\n\t"dependencies": {\n\t\t"${t}/gen-shared": "file:../shared"\n\t},`);const i=`{\n  "name": "${t}/${n}",\n  "version": "1.0.${s}",${r}\n  "main": "./dist/mjs/index.js",\n  "typings": "./dist/mjs/index.d.ts",\n\t"type": "module",\n\t"scripts": { \n\t\t"build": "tsc"\n\t}\n}`;u.writeFileSync(e,i)}(e.outputPath+"/client/package.json",e.scope,e.clientPackageName,!0),function(e,t,n,o=!1){const s=(new Date).getTime();let r="";o&&(r=`\n\t"dependencies": {\n\t\t"${t}/gen-shared": "file:../shared"\n\t},`);const i=`{\n  "name": "${t}/${n}",\n  "version": "1.0.${s}",${r}\n  "main": "./dist/cjs/index.js",\n\t"type": "commonjs",\n  "typings": "./dist/cjs/index.d.ts",\n\t"scripts": { \n\t\t"build": "tsc"\n\t}\n}`;u.writeFileSync(e,i)}(e.outputPath+"/server/package.json",e.scope,e.serverPackageName,!0),h(e.outputPath+"/shared/tsconfig.json"),g(e.outputPath+"/shared/tsconfig-esm.json"),g(e.outputPath+"/client/tsconfig.json"),h(e.outputPath+"/server/tsconfig.json")}(e),s=e.outputPath,l(["npx tsc","npx tsc -p tsconfig-esm.json"],{cwd:s+"/shared",stdio:"inherit"}),l(["npx tsc"],{cwd:s+"/client",stdio:"inherit"}),l(["npx tsc"],{cwd:s+"/server",stdio:"inherit"});var s};const a=n(317),c=n(78),p=i(n(911)),u=i(n(947));function l(e,t){try{e.forEach(e=>{(0,a.execSync)(e,t)})}catch(e){console.error("ROOTPROTOC - Error: ",e.message),process.exit(1)}}function d(e){return(Array.isArray(e)?e:[e]).map(e=>p.resolve(e))}function m(e){if(!u.existsSync(e))try{u.mkdirSync(e,{recursive:!0})}catch(t){console.error(`ROOTPROTOC - Error: Failed to create directory ${e}.`,t.message),process.exit(1)}}function h(e){u.writeFileSync(e,'\n{\n  "compilerOptions": {\n    "target": "ES2020",\n    "composite": true,\n    "declaration": true,\n    "outDir": "./dist/cjs/",\n    "module": "commonjs",\n    "moduleResolution": "node",\n    "resolveJsonModule": true,\n    "sourceMap": true,\n    "allowJs": false,\n    "forceConsistentCasingInFileNames": true,\n    "noImplicitReturns": true,\n    "noImplicitThis": true,\n    "noImplicitAny": true,\n    "strictNullChecks": true,\n    "noUnusedLocals": false,\n    "noUnusedParameters": false,\n    "esModuleInterop": true,\n    "rootDir": "./src"\n  },\n  "include": [ "./src/**/*.ts" ],\n  "exclude": [ "node_modules", "**/*.spec.ts"]\n}\n')}function g(e){u.writeFileSync(e,'\n{\n  "compilerOptions": {\n    "target": "ES2020",\n    "composite": true,\n    "declaration": true,\n    "outDir": "./dist/mjs/",\n    "module": "ESNext",\n    "isolatedModules": true,\n    "moduleResolution": "Bundler",\n    "resolveJsonModule": true,\n    "sourceMap": true,\n    "allowJs": false,\n    "forceConsistentCasingInFileNames": true,\n    "noImplicitReturns": true,\n    "noImplicitThis": true,\n    "noImplicitAny": true,\n    "strictNullChecks": true,\n    "noUnusedLocals": false,\n    "noUnusedParameters": false,\n    "sourceRoot": "./src",\n    "rootDir": "./src"\n  },\n  "include": [ "./src/**/*.ts" ],\n  "exclude": [ "node_modules", "**/*.spec.ts"]\n}\n')}},78:t=>{t.exports=e},317:e=>{e.exports=require("child_process")},911:e=>{e.exports=t},947:e=>{e.exports=n}},s={};var r=function e(t){var n=s[t];if(void 0!==n)return n.exports;var r=s[t]={exports:{}};return o[t].call(r.exports,r,r.exports,e),r.exports}(57);return r})());